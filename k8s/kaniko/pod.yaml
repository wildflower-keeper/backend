apiVersion: v1
kind: Pod
metadata:
  namespace: kisacloud2407
spec:
  containers:
    - name: jnlp
      image: jenkins/inbound-agent:latest
      resources:
        limits:
          cpu: '500m'
          memory: '512Mi'
        requests:
          cpu: '250m'
          memory: '256Mi'
    - name: kaniko
      image: gcr.io/kaniko-project/executor:debug
      env:
        - name: RDS_USERNAME
          valueFrom:
            secretKeyRef:
              name: rds-secret
              key: RDS_USERNAME
        - name: RDS_PW
          valueFrom:
            secretKeyRef:
              name: rds-secret
              key: RDS_PW
      command:
        - /busybox/cat
      tty: true
      resources:
        limits:
          cpu: '2'
          memory: '2Gi'
        requests:
          cpu: '1'
          memory: '1Gi'
      volumeMounts:
        - name: docker-config
          mountPath: /kaniko/.docker
        - name: workspace-volume
          mountPath: /workspace
  volumes:
    - name: docker-config
      secret:
        secretName: docker-hub-secret
        items:
          - key: .dockerconfigjson
            path: config.json
    - name: workspace-volume
      hostpath:
        path: /home/jenkins/agent/workspace
